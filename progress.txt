## Iteration 1 - Project Setup (Vite + React + Tailwind + PWA)
- Initialized npm project with React 19, Vite 7, Tailwind CSS v4, vite-plugin-pwa
- Created project structure: src/components, src/hooks, src/data, public/assets/watercolors, public/icons
- Set up index.html with viewport meta, Google Fonts (Inter + Playfair Display), theme-color
- Created src/index.css with Tailwind v4 import and all CSS variables from brand guidelines
- Created src/main.jsx and src/App.jsx with basic rendering
- Copied watercolor images to public/assets/watercolors/
- Created .gitignore
- Files changed: package.json, vite.config.js, index.html, src/main.jsx, src/App.jsx, src/index.css, .gitignore
- Learnings for future iterations:
  - The project path contains an apostrophe ("Mama's Birthday") which breaks workbox service worker generation. vite-plugin-pwa is installed but disabled in vite.config.js. Re-enable when deploying from a clean CI path.
  - Tailwind v4 uses `@import "tailwindcss"` instead of the old `@tailwind` directives
  - Using `type: "module"` in package.json for ESM
  - Build verified working with `npx vite build`
---

## Iteration 2 - Tile Rendering
- Created src/data/tiles.js with all 144 tile definitions (Dots/Bams/Craks x9x4, Winds x4x4, Dragons x3x4, Flowers x4, Seasons x4)
- Includes tile labels, suit labels (Chinese characters), color mappings per suit, flower/season image mappings
- Includes tilesMatch() function with special flower/season matching rules
- Includes generateTileSet() that produces exactly 144 tiles
- Created src/components/Tile.jsx - renders individual tile with:
  - Watercolor background tint per suit (Dots=blue, Bams=green, Craks=pink, etc.)
  - Full watercolor painting background (30% opacity) for flower and season tiles
  - High-contrast symbol + suit label overlay
  - Selected state (lifted, lavender border, enhanced shadow)
  - Blocked/free state (dimmed, desaturated when blocked)
  - Accessible button element with aria-label
- Updated App.jsx to render a preview grid of all unique tile types
- Files changed: src/data/tiles.js (new), src/components/Tile.jsx (new), src/App.jsx (updated), PRD.md
- Learnings for future iterations:
  - Watercolor images available: tiles_1.png through tiles_8.png, tiles_4.jpg/5.jpg/7.jpg are JPG, rest PNG
  - bg-texture.png available for board background texture
  - Tile component uses inline styles for dynamic coloring (suit-specific) + Tailwind for layout
  - generateTileSet() returns tiles with {id, suit, value, copy} - positions added later by layout
  - Build verified with `npx vite build` - passes clean
---

## Iteration 3 - Classic Layout (Turtle/Pyramid with 144 tiles)
- Created src/data/layout.js with the classic "Turtle" Mahjong Solitaire layout
  - 5 layers: Layer 0 (87 tiles), Layer 1 (40), Layer 2 (14), Layer 3 (2), Layer 4 (1 peak) = 144 total
  - Layer 0 has classic turtle body shape with 3 wing tiles (2 left, 1 right)
  - Upper layers offset by +0.5 in x/y so tiles center over 4 tiles below
  - All 144 positions verified unique
- Implemented isTileFree() function for free tile detection:
  - Checks no overlapping tile on higher layer (within 1-unit footprint)
  - Checks at least one side (left or right) is open
  - Validated: 26 free tiles on fresh board, peak is free, center bottom blocked
- Implemented getLayoutBounds() for board centering/scaling calculations
- Created src/components/Board.jsx:
  - Renders all tiles with absolute positioning based on grid coordinates
  - 3D stacking visual with layer offsets (LAYER_OFFSET_X=-2, LAYER_OFFSET_Y=-4)
  - Proper z-index ordering (painter's algorithm: sorted by z, y, x)
  - Responsive tile sizing: desktop 60×80, tablet 50×66, mobile 36×48
  - Listens to window resize to adjust tile sizes
- Updated Tile.jsx to accept tileWidth/tileHeight props with proportional font scaling
- Updated App.jsx to use Board component with Fisher-Yates shuffled tiles
  - createGame() shuffles tile definitions and assigns to layout positions
  - Computes free tiles via useMemo for efficient re-rendering
  - Selection toggle (match logic deferred to later task)
- Files changed: src/data/layout.js (new), src/components/Board.jsx (new), src/components/Tile.jsx (updated), src/App.jsx (updated), PRD.md
- Learnings for future iterations:
  - Layout uses half-unit coordinates (e.g., 0.5, 3.5) for layer offsets and wing positions
  - isTileFree uses OVERLAP_THRESHOLD of 0.99 to handle floating point comparisons
  - Left/right neighbor detection uses exact match (0.01 tolerance) on x offset of 1, with y overlap within 1 unit
  - Board component computes pixel positions: (gridX - minX) * tileW + z * layerOffsetX
  - Free tile detection runs on every tiles state change — may need optimization later if slow
  - Build verified with `npx vite build` - passes clean
---

## Iteration 4 - Responsive Design (Desktop + Mobile)
- Rewrote Board.jsx to auto-scale tiles to fit available viewport space
  - Measures container content area (accounting for padding) on mount and resize
  - Calculates max tile width that fits both dimensions using layout bounds and aspect ratio
  - Clamped to min 32px (touch target) / max 60px (desktop cap)
  - Layer offsets scale proportionally with tile size (ratio-based instead of fixed pixels)
- Updated App.jsx layout structure:
  - Header uses flex-shrink-0 with compact padding on mobile (py-2) and more on desktop (lg:py-3)
  - Title text scales: text-lg on mobile, sm:text-xl tablet, lg:text-3xl desktop
  - Board area uses flex-1 min-h-0 to fill remaining viewport height
  - overflow-hidden on root container prevents scrolling
- Updated Tile.jsx:
  - Added `tile-free` CSS class for hover targeting
  - Border width scales proportionally with tile size
  - Border radius scales proportionally
  - Font sizes have minimum floors to stay readable at small tile sizes
- Added CSS hover/touch states in index.css:
  - `@media (hover: hover) and (pointer: fine)` — desktop-only hover: lavender glow + slight lift
  - `.tile:active` — tap feedback with scale(0.96) on all devices
- Files changed: src/components/Board.jsx (rewritten), src/components/Tile.jsx (updated), src/App.jsx (updated), src/index.css (updated), PRD.md
- Learnings for future iterations:
  - Board auto-scaling math: gridW = bounds.width + layers * |layerOffXRatio|, gridH = bounds.height / TILE_ASPECT + layers * |layerOffYRatio| / TILE_ASPECT. tileW = min(availW/gridW, availH/gridH)
  - Must subtract padding from clientWidth/Height when measuring container (getComputedStyle)
  - `@media (hover: hover) and (pointer: fine)` correctly excludes touch devices from hover effects
  - MIN_TILE_W of 32px is safe — tiles overlap in layout so effective touch targets are larger than individual tile size
  - Build verified with `npx vite build` - passes clean
---
